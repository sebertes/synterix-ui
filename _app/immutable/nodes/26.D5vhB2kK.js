import"../chunks/CWj6FrbW.js";import{p as Pe,a as te,u as De,e as r,d as t,t as Re,b as ke,r as a,n as Te}from"../chunks/QwNgEtIe.js";import{s as d}from"../chunks/DGaM1_9x.js";import{t as Ee,a as Ke}from"../chunks/DU17d604.js";import{s as ae}from"../chunks/D7ICzF4-.js";import{s as x}from"../chunks/DlV0Rhhi.js";import{o as Me}from"../chunks/CfWhJ7d3.js";import{T as Ne}from"../chunks/BKZmce3h.js";import{K as Se}from"../chunks/BGXyWBGH.js";import{R as m,K as v}from"../chunks/atN2Jykg.js";const se={_getDependence(){let c=[];return[m.Pod,m.Node,m.NodeMetrics,m.Deployment].forEach(n=>{n._getDependence().forEach(o=>{c.includes(o)||c.push(o)})}),c},ready(c){let n=this._getDependence();n.forEach(o=>o.keeper.get()),n.find(o=>!o.keeper.done)===void 0&&c&&c()},getClusterStatistic(){var u;let c=m.Node.getAllRawList(),n=m.Pod.getAllRawList(),o=m.NodeMetrics.getAllRawList(),j=m.Deployment.getAllRawList();const e={age:null,cpu:{capacity:0,usage:0,allocatable:0,reserved:0,percent:0,reservedPercent:0},memory:{capacity:0,usage:0,allocatable:0,reserved:0,percent:0,reservedPercent:0},pods:{total:n.length,capacity:0,percent:0},deployments:{total:j.length},nodes:{total:c.length},version:(u=c[0])==null?void 0:u.status.nodeInfo.kubeletVersion};let z=c,s=null;return z=z.filter(i=>(s?new Date(i.metadata.creationTimestamp)<s&&(s=new Date(i.metadata.creationTimestamp)):s=new Date(i.metadata.creationTimestamp),i.metadata.labels["node-role.kubernetes.io/worker"]==="true")),e.age=v.formatAge(new Date(s).toISOString()),z.forEach(i=>{var l,p,f,b,y;e.cpu.capacity+=v.unitConvert.cpu.parse(((l=i.status.capacity)==null?void 0:l.cpu)||"0"),e.cpu.allocatable+=v.unitConvert.cpu.parse(((p=i.status.allocatable)==null?void 0:p.cpu)||"0"),e.memory.capacity+=v.unitConvert.memory.parse(((f=i.status.capacity)==null?void 0:f.memory)||"0"),e.memory.allocatable+=v.unitConvert.memory.parse(((b=i.status.allocatable)==null?void 0:b.memory)||"0"),e.pods.capacity+=parseInt(((y=i.status.capacity)==null?void 0:y.pods)||"0")}),n.forEach(i=>{i.spec.containers.forEach(l=>{l.resources&&l.resources.requests&&(l.resources.requests.cpu&&(e.cpu.reserved+=v.unitConvert.cpu.parse(l.resources.requests.cpu)),l.resources.requests.memory&&(e.memory.reserved+=v.unitConvert.memory.parse(l.resources.requests.memory)))})}),o.forEach(i=>{var l,p;e.cpu.usage+=v.unitConvert.cpu.parse(((l=i.usage)==null?void 0:l.cpu)||"0"),e.memory.usage+=v.unitConvert.memory.parse(((p=i.usage)==null?void 0:p.memory)||"0")}),e.cpu.capacity&&(e.cpu.percent=v.unitConvert.format(e.cpu.usage/e.cpu.capacity*100)),e.memory.capacity&&(e.memory.percent=v.unitConvert.format(e.memory.usage/e.memory.capacity*100)),e.cpu.allocatable&&(e.cpu.reservedPercent=v.unitConvert.format(e.cpu.reserved/e.cpu.allocatable*100)),e.memory.allocatable&&(e.memory.reservedPercent=v.unitConvert.format(e.memory.reserved/e.memory.allocatable*100)),e.pods.capacity&&(e.pods.percent=v.unitConvert.format(e.pods.total/e.pods.capacity*100)),e.memory.capacity=v.unitConvert.format(e.memory.capacity),e.memory.usage=v.unitConvert.format(e.memory.usage),e.memory.allocatable=v.unitConvert.format(e.memory.allocatable),e.memory.reserved=v.unitConvert.format(e.memory.reserved),e.cpu.capacity=v.unitConvert.format(e.cpu.capacity),e.cpu.usage=v.unitConvert.format(e.cpu.usage),e.cpu.allocatable=v.unitConvert.format(e.cpu.allocatable),e.cpu.reserved=v.unitConvert.format(e.cpu.reserved),e}};var Ae=Ee(`<div class="content svelte-1xbzjnz"><div class="header svelte-1xbzjnz"><div class="header-title svelte-1xbzjnz">Cluster Dashboard</div></div> <div class="banner">The base Kubernetes Node resource represents a virtual or physical machine which hosts
        deployments. To manage the machine lifecyle, if available, go to Cluster Management.</div> <div class="line svelte-1xbzjnz"><div class="item svelte-1xbzjnz"><span class="svelte-1xbzjnz">Kubernetes Version:</span><span class="svelte-1xbzjnz"> </span></div> <div class="item svelte-1xbzjnz"><span class="svelte-1xbzjnz">Created:</span><span class="svelte-1xbzjnz"> </span></div></div> <div class="nums svelte-1xbzjnz"><div class="num svelte-1xbzjnz"><div class="dot svelte-1xbzjnz"> </div> <div class="label svelte-1xbzjnz">Total Resources</div></div> <div class="margin svelte-1xbzjnz"></div> <div class="num as-btn svelte-1xbzjnz"><div class="dot svelte-1xbzjnz"> </div> <a class="dived label label-btn svelte-1xbzjnz">Nodes</a></div> <div class="margin svelte-1xbzjnz"></div> <div class="num as-btn svelte-1xbzjnz"><div class="dot svelte-1xbzjnz"> </div> <a class="dived label label-btn svelte-1xbzjnz">Deployments</a></div></div> <div class="title svelte-1xbzjnz">Capacity</div> <div class="statistics svelte-1xbzjnz"><div class="statistic svelte-1xbzjnz"><div class="label svelte-1xbzjnz">Pods</div> <div class="desc svelte-1xbzjnz"><div class="left svelte-1xbzjnz">Used</div> <div class="info svelte-1xbzjnz"> </div> <div class="right svelte-1xbzjnz"> </div></div> <div class="bar svelte-1xbzjnz"><div class="bar-in svelte-1xbzjnz"></div></div></div> <div class="margin"></div> <div class="statistic svelte-1xbzjnz"><div class="label svelte-1xbzjnz">Cores</div> <div class="desc svelte-1xbzjnz"><div class="left svelte-1xbzjnz">Reserved</div> <div class="info svelte-1xbzjnz"> </div> <div class="right svelte-1xbzjnz"> </div></div> <div class="bar svelte-1xbzjnz"><div class="bar-in svelte-1xbzjnz"></div></div> <div class="desc svelte-1xbzjnz"><div class="left svelte-1xbzjnz">Used</div> <div class="info svelte-1xbzjnz"> </div> <div class="right svelte-1xbzjnz"> </div></div> <div class="bar svelte-1xbzjnz"><div class="bar-in svelte-1xbzjnz"></div></div></div> <div class="margin"></div> <div class="statistic svelte-1xbzjnz"><div class="label svelte-1xbzjnz">Memory</div> <div class="desc svelte-1xbzjnz"><div class="left svelte-1xbzjnz">Reserved</div> <div class="info svelte-1xbzjnz"> </div> <div class="right svelte-1xbzjnz"> </div></div> <div class="bar svelte-1xbzjnz"><div class="bar-in svelte-1xbzjnz"></div></div> <div class="desc svelte-1xbzjnz"><div class="left svelte-1xbzjnz">Used</div> <div class="info svelte-1xbzjnz"> </div> <div class="right svelte-1xbzjnz"> </div></div> <div class="bar svelte-1xbzjnz"><div class="bar-in svelte-1xbzjnz"></div></div></div></div> <div class="title svelte-1xbzjnz">Alerts</div> <div class="tables svelte-1xbzjnz"><!></div></div>`);function Je(c,n){Pe(n,!0);let o=te([]),j=[{name:"Severity",key:"status",align:"left",width:"150px"},{name:"Name",key:"name",align:"left"},{name:"Message",key:"namespace",align:"left",width:"330px"}],e=[],z=[],s=te({total:0,age:"--",cpu:{capacity:0,usage:0,allocatable:0,reserved:0,percent:0,reservedPercent:0},memory:{capacity:0,usage:0,allocatable:0,reserved:0,percent:0,reservedPercent:0},pods:{total:0,capacity:0,percent:0},deployments:{total:0},nodes:{total:0},version:"--"});Me(async()=>{let{data:_}=await Se.resourceCount.post(),ee=0;Reflect.ownKeys(_||{}).forEach($e=>{ee+=_[$e]}),s.total=ee}),De(()=>{se.ready(()=>{let _=se.getClusterStatistic();Object.assign(s,_)})});var u=Ae(),i=r(t(u),4),l=t(i),p=r(t(l)),f=t(p,!0);a(p),a(l);var b=r(l,2),y=r(t(b)),re=t(y,!0);a(y),a(b),a(i);var g=r(i,2),h=t(g),O=t(h),ve=t(O,!0);a(O),Te(2),a(h);var C=r(h,4),w=t(C),ie=t(w,!0);a(w);var le=r(w,2);a(C);var V=r(C,4),$=t(V),de=t($,!0);a($);var ce=r($,2);a(V),a(g);var P=r(g,4),D=t(P),R=r(t(D),2),k=r(t(R),2),ne=t(k);a(k);var B=r(k,2),oe=t(B);a(B),a(R);var F=r(R,2),pe=t(F);a(F),a(D);var T=r(D,4),E=r(t(T),2),K=r(t(E),2),me=t(K);a(K);var G=r(K,2),ue=t(G);a(G),a(E);var M=r(E,2),ze=t(M);a(M);var N=r(M,2),S=r(t(N),2),be=t(S);a(S);var H=r(S,2),ye=t(H);a(H),a(N);var J=r(N,2),xe=t(J);a(J),a(T);var Q=r(T,4),A=r(t(Q),2),q=r(t(A),2),fe=t(q);a(q);var W=r(q,2),_e=t(W);a(W),a(A);var L=r(A,2),je=t(L);a(L);var U=r(L,2),I=r(t(U),2),ge=t(I);a(I);var X=r(I,2),he=t(X);a(X),a(U);var Y=r(U,2),Ce=t(Y);a(Y),a(Q),a(P);var Z=r(P,4),we=t(Z);Ne(we,{header:j,get data(){return o},buttons:e,menus:z,checkbox:!1}),a(Z),a(u),Re(()=>{d(f,s.version),d(re,s.age),d(ve,s.total),d(ie,s.nodes.total),ae(le,"href",`/dashboard/${n.data.clusterPath??""}/resources/nodes`),d(de,s.deployments.total),ae(ce,"href",`/dashboard/${n.data.clusterPath??""}/resources/deployments`),d(ne,`${s.pods.total??""}/${s.pods.capacity??""}`),d(oe,`${s.pods.percent??""}%`),x(pe,`width: ${s.pods.percent??""}%`),d(me,`${s.cpu.reserved??""}
                    /${s.cpu.capacity??""}`),d(ue,`${s.cpu.reservedPercent??""}%`),x(ze,`width: ${s.cpu.reservedPercent??""}%`),d(be,`${s.cpu.usage??""}
                    /${s.cpu.capacity??""}`),d(ye,`${s.cpu.percent??""}%`),x(xe,`width: ${s.cpu.percent??""}%`),d(fe,`${s.memory.reserved??""}
                    /${s.memory.capacity??""}`),d(_e,`${s.memory.reservedPercent??""}%`),x(je,`width: ${s.memory.reservedPercent??""}%`),d(ge,`${s.memory.usage??""}
                    /${s.memory.capacity??""}`),d(he,`${s.memory.percent??""}%`),x(Ce,`width: ${s.memory.percent??""}%`)}),Ke(c,u),ke()}export{Je as component};
